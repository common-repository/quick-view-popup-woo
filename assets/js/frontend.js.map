{"version":3,"file":"frontend.js","sources":["../../src/frontend/popup.js","../../src/frontend/helper.js","../../src/frontend.js"],"sourcesContent":["import '../css/popup.scss';\n\nconst WPVQV_Popup = {\n    // Function to create a popup\n    createPopup: function(content, options) {\n        const defaultOptions = {\n            width: '400px',\n            height: '300px',\n            title: '',\n            onClose: function() {},\n            onOpen: function() {},\n            galleryMode: false,\n            galleryItems: [],\n            currentIndex: 0,\n            overlay: true,\n            closeOnEscape: true,\n            closeOnClickOutside: true\n        };\n\n        options = Object.assign({}, defaultOptions, options);\n\n        // Create overlay if enabled\n        let overlay = null;\n        if (options.overlay) {\n            overlay = document.createElement('div');\n            overlay.classList.add('wpvqv-overlay');\n            document.body.appendChild(overlay);\n        }\n\n        const popupContainer = document.createElement('div');\n        popupContainer.classList.add('wpvqv-popup-container');\n        popupContainer.style.width = options.width;\n        popupContainer.style.height = options.height;\n\n        const closeButton = document.createElement('button');\n        closeButton.classList.add('wpvqv-popup-close-btn');\n        closeButton.innerHTML = '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 1024 1024\" data-v-ea893728=\"\"><path fill=\"currentColor\" d=\"M764.288 214.592 512 466.88 259.712 214.592a31.936 31.936 0 0 0-45.12 45.12L466.752 512 214.528 764.224a31.936 31.936 0 1 0 45.12 45.184L512 557.184l252.288 252.288a31.936 31.936 0 0 0 45.12-45.12L557.12 512.064l252.288-252.352a31.936 31.936 0 1 0-45.12-45.184z\"></path></svg>';\n        closeButton.addEventListener('click', function() {\n            WPVQV_Popup.closePopup(popupContainer, overlay, options.onClose);\n        });\n\n        const popupContent = document.createElement('div');\n        popupContent.classList.add('wpvqv-popup-content');\n        popupContent.innerHTML = content;\n\n        popupContent.appendChild(closeButton);\n\n        if(options.title){\n            const popupTitle = document.createElement('div');\n            popupTitle.classList.add('wpvqv-popup-title');\n            popupTitle.textContent = options.title;\n        }\n        \n\n        \n\n        // Close popup on Escape key if enabled\n        if (options.closeOnEscape) {\n            document.addEventListener('keydown', function(event) {\n                if (event.key === 'Escape') {\n                    WPVQV_Popup.closePopup(popupContainer, overlay, options.onClose);\n                }\n            });\n        }\n\n        if(options.title){\n            popupContainer.appendChild(popupTitle);\n        }\n        //popupContainer.appendChild(closeButton);\n        popupContainer.appendChild(popupContent);\n\n        if (options.galleryMode) {\n            const galleryButtons = document.createElement('div');\n            galleryButtons.classList.add('wpvqv-gallery-buttons');\n            galleryButtons.appendChild(prevButton);\n            galleryButtons.appendChild(nextButton);\n            popupContainer.appendChild(galleryButtons);\n        }\n\n        document.body.appendChild(popupContainer);\n\n        options.onOpen();\n\n        // Close popup on click outside if enabled\n        if (options.closeOnClickOutside) {\n            overlay.addEventListener('click', function() {\n                WPVQV_Popup.closePopup(popupContainer, overlay, options.onClose);\n            });\n            popupContainer.addEventListener('click', function(event) {\n                event.stopPropagation();\n            });\n        }\n\n        // Disable scrolling on the page behind the popup\n        document.body.style.overflow = 'hidden';\n    },\n\n    // Function to close a popup\n    closePopup: function(popupContainer, overlay, onClose) {\n        \n        if (popupContainer && overlay) {\n            popupContainer.parentNode.removeChild(popupContainer);\n            overlay.parentNode.removeChild(overlay);\n            document.body.style.overflow = '';\n            onClose();\n        }\n    }\n};\n\nexport default WPVQV_Popup;","export async function getProductHtml(product_id) {\n\n    const formData = new FormData();\n\n    formData.append('action', 'wpvqv_quick_view');\n    formData.append('product_id', product_id);\n    formData.append('wpvcp_security', wpvqv.security);\n\n    const response = await fetch(wpvqv.ajaxurl, {\n        method: 'POST',\n        body: formData\n    });\n    const data = await response.text();\n    return data;\n\n}\n    ","import Popup from './frontend/popup';\nimport { getProductHtml } from './frontend/helper';\nimport './css/frontend.scss';\n\n\n\nconst popupButtons = document.querySelectorAll('.wpvqv-quick-view-btn');\n\npopupButtons.forEach((button) => {\n\n    button.addEventListener('click', (e) => {\n        e.preventDefault();\n\n        let product_id = button.getAttribute('data-product_id');\n\n        let popupContent = document.querySelector('.popup-content');\n\n        // get table\n        getProductHtml(product_id).then((html) => {\n\n            Popup.createPopup(html, {\n                width: '60%',\n                height: '55vh',\n                onClose: function() {\n\n                },\n                onOpen: function() {\n                    jQuery('.woocommerce-product-gallery').wc_product_gallery( wc_single_product_params );\n\n                    jQuery('.variations_form').each(function() {\n                        jQuery(this).wc_variation_form();\n                        var $variation_form = jQuery(this);\n                        $variation_form.on('found_variation', function(event, variation) {\n                            // Update the main product image based on the selected variation\n                            if (variation && variation.image.src) {\n                                updateMainProductImage(variation.image);\n                            }\n                        });\n                        $variation_form.on('reset_data', function() {\n                            // Get the first variation image\n                            var first_variation = $variation_form.data('product_variations')[1];\n                            if (first_variation && first_variation.image.src) {\n                                updateMainProductImage(first_variation.image);\n                            }\n                        });\n                    });\n                    // Initialize WooCommerce quantity script\n                    jQuery('.cart').each(function() {\n                        jQuery(this).wc_variation_form();\n                    });\n                }\n            });\n\n        });\n    });\n});\n// Create a popup\nfunction updateMainProductImage(image) {\n    let wooProductGallery = document.querySelector('.woocommerce-product-gallery');\n    if(wooProductGallery){\n        let thumbs = wooProductGallery.querySelector('.flex-control-thumbs');\n        let thumbsImage = thumbs.querySelector( 'li img[src=\"' + image.gallery_thumbnail_src + '\"]');\n        if(thumbsImage == null){\n            image_reset(image);\n        }else{\n            jQuery(thumbsImage).trigger('click');\n        }\n    }\n}\n\nfunction image_reset(image){\n    let productGallery = document.querySelector('.woocommerce-product-gallery');\n    let gallery_nav = productGallery.querySelector('.flex-control-nav');\n    let gallery_img = gallery_nav.querySelector('li:first-child img');\n    \n    product_img_wrap = productGallery.querySelector('.woocommerce-product-gallery__image, .woocommerce-product-gallery__image--placeholder');        \n    product_img = product_img_wrap.querySelector('.wp-post-image');\n    \n    product_link = product_img_wrap.querySelector('a');\n    \n    product_zoom_image = product_img_wrap.querySelector('.zoomImg');\n    if(product_zoom_image){\n        product_zoom_image.setAttribute('src',image.src);\n    }\n    \n    product_img.setAttribute('src',image.src);\n    product_img.setAttribute('height',image.src_h);\n    product_img.setAttribute('width',image.src_w);\n    product_img.setAttribute('srcset',image.srcset);\n    product_img.setAttribute('sizes',image.sizes);\n    product_img.setAttribute('title',image.title);\n    product_img.setAttribute('data-caption',image.caption);\n    product_img.setAttribute('alt',image.alt);\n    product_img.setAttribute('data-src',image.full_src);\n\n    product_img.setAttribute('data-large_image',image.full_src);\n    product_img.setAttribute('data-large_image_width',image.full_src_w);\n    product_img.setAttribute('data-large_image_height',image.full_src_h);\n\n    $(product_img_wrap).wc_set_variation_attr( 'data-thumb', image.src );\n\n    gallery_img.setAttribute( 'src',image.gallery_thumbnail_src );\n    product_link.setAttribute( 'href',image.full_src );\n    \n    $(gallery_img).trigger('click');\n}"],"names":["WPVQV_Popup","content","options","overlay","popupContainer","closeButton","popupContent","popupTitle","event","galleryButtons","onClose","getProductHtml","product_id","formData","popupButtons","button","e","html","Popup","$variation_form","variation","updateMainProductImage","first_variation","image","wooProductGallery","thumbsImage","image_reset","productGallery","gallery_img"],"mappings":"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"}